# Screator UI

A desktop application built with Angular 20 and Electron for editing AI-generated scripts with slide suggestions. The Screator UI provides an intuitive interface for managing script paragraphs and their associated slide content through an intelligent matching system.

## Overview

Screator UI is the desktop editor component of the script-generator pipeline. It allows users to:
- Edit script paragraphs generated by the AI pipeline
- View and select from AI-suggested slides for each paragraph
- Browse a complete slide library
- Manage slide assignments with undo/redo functionality
- Export edited scripts back to the pipeline

## Tech Stack

- **Angular 20** - Modern web framework with standalone components
- **Electron 38** - Desktop application wrapper with Node.js integration
- **NgRx** - State management with undo/redo support
- **PrimeNG** - UI component library with themes
- **TypeScript** - Type-safe development

## Prerequisites

- Node.js (recommended: latest LTS version)
- npm package manager
- The main script-generator pipeline must be set up and have generated output files

## Installation

1. Navigate to the screator-ui directory:
   ```bash
   cd screator-ui
   ```

2. Install dependencies:
   ```bash
   npm install
   ```

## Development

### Running the Application

Start the development version with hot reload:
```bash
npm run start
```

This command:
1. Builds the Angular application with source maps (`ng build --source-map`)
2. Launches the Electron desktop application

### Building for Production

Build the Angular application:
```bash
npm run build
```

Build artifacts are stored in the `dist/screator-ui/browser/` directory.

### Running Tests

Execute unit tests:
```bash
npm run test
```

### Development Server Only

For Angular-only development (without Electron):
```bash
npm run watch
```

## Application Structure

### Core Components

- **AppComponent** - Main editor interface with paragraph management
- **State Management** - NgRx store with actions, reducers, and selectors
- **Models** - TypeScript interfaces for paragraphs, slides, and matches

### Key Features

1. **Script Editing**
   - Load generated scripts from `../output/<id>/script.json`
   - Edit paragraph text with real-time updates
   - Split paragraphs for better organization

2. **Slide Management**
   - View AI-suggested slides with confidence scores
   - Browse complete slide library
   - Select/deselect slides for paragraphs
   - Clear all slide assignments

3. **State Management**
   - Full undo/redo history
   - Automatic state persistence
   - Completion progress tracking

4. **File Integration**
   - Reads from script-generator output directory
   - Saves edited scripts as `script_edited.json`
   - Integrates with slide images and descriptions

### File Structure

```
src/app/
├── app.component.ts          # Main editor component
├── app.component.html        # Editor template
├── app.component.css         # Component styles
├── app.model.ts             # TypeScript interfaces
├── app.actions.ts           # NgRx actions
├── app.reducers.ts          # NgRx state management
├── app.selectors.ts         # NgRx state selectors
├── app.config.ts            # Application configuration
└── app.routes.ts            # Routing configuration
```

## Data Flow

1. **Input**: Reads `script.json` and `slide_matches.json` from `../output/<id>/`
2. **Processing**: Loads data into NgRx store with slide candidates
3. **Editing**: User interacts with paragraphs and slide selections
4. **Output**: Saves modified state to `script_edited.json`

## Configuration

The application expects the following file structure relative to the screator-ui directory:

```
../output/<id>/
├── script.json              # Generated script paragraphs
├── slide_matches.json       # AI-generated slide suggestions
├── slide_descriptions.json  # Slide metadata
└── slides/                  # Slide image files
    ├── slide001.png
    ├── slide002.png
    └── ...
```

## Electron Integration

The application uses Electron with:
- **Node.js Integration** - Enabled for file system access
- **Context Isolation** - Disabled for direct Node.js API access
- **Hot Reload** - Automatic restart during development
- **Full Screen** - Maximized window on startup

## State Management

The application uses NgRx for comprehensive state management:

- **Actions**: Script loading/saving, paragraph editing, slide selection
- **Reducers**: Immutable state updates with deep copying
- **Selectors**: Computed state derivatives and statistics
- **Undo/Redo**: Manual history stack management

## Development Tips

1. **File Paths**: The application uses relative paths (`../output/`) to access generated files
2. **State Debugging**: NgRx DevTools are enabled for state inspection
3. **Hot Reload**: Changes to TypeScript/HTML files trigger automatic rebuilds
4. **Electron DevTools**: Available in development mode for debugging

## Integration with Main Pipeline

This UI component is designed to work with the main script-generator pipeline:

1. Run the main pipeline: `python main.py input/<id>`
2. Launch the UI: `npm run start` 
3. Edit scripts in the UI
4. Generate final output: `python script_generator_edited.py output/<id>`

## Troubleshooting

- **File Not Found**: Ensure the main pipeline has generated output files
- **Electron Issues**: Check that Node.js integration is properly configured
- **Build Errors**: Verify all dependencies are installed with `npm install`
- **State Issues**: Use NgRx DevTools to inspect application state

## Contributing

When extending the application:
- Maintain immutable state patterns in reducers
- Update TypeScript interfaces for new data structures
- Preserve file path conventions for pipeline integration
- Add comprehensive typing for new features
